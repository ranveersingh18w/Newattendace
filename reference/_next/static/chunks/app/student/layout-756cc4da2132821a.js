(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{1686:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>s});var r=a(95155),o=a(84867);function s(t){let{children:e}=t;return(0,r.jsx)(o.h,{children:e})}},31886:(t,e,a)=>{"use strict";a.d(e,{Cc:()=>c,FH:()=>i,hU:()=>l});var r=a(23464),o=a(8777),s=a.n(o);let d="http://103.159.68.35:3536/api",n=()=>{let t=Date.now().toString(),e=s().createHmac("sha256","6ECD762D4776742AFFB192CE8A148").update(t).digest("hex");return"".concat(t,".").concat(e)},i=r.A.create({baseURL:d,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(t=>(t.headers["X-App-Signature"]=n(),t));let l=t=>{let e=r.A.create({baseURL:d,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});return e.interceptors.request.use(t=>(t.headers["X-App-Signature"]=n(),t)),e},u=()=>localStorage.getItem("token"),c=()=>{let t=u();if(!t)throw Error("No authentication token found");return l(t)}},66982:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var r=a(31886);let o=()=>{let t=localStorage.getItem("studentToken");if(!t)throw Error("No student authentication token found");return(0,r.hU)(t)},s={async register(t){try{return(await r.FH.post("/student/auth/register",t)).data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Registration failed")}},async verifyEmail(t){try{return(await r.FH.post("/student/auth/verify-email",{token:t})).data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Email verification failed")}},async resendEmailVerification(t){try{return(await r.FH.post("/student/auth/resend-verification",{rollNumber:t})).data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Failed to resend verification email")}},async login(t){try{let e=await r.FH.post("/student/auth/login",t);if(!e.data.token)return console.error("Login failed: No token received"),e.data.message;localStorage.setItem("studentToken",e.data.token),localStorage.setItem("studentId",e.data.student.id),localStorage.setItem("userType","student");try{o().post("/student/dashboard/activity-log",{action:"STUDENT_LOGIN"}).catch(()=>{})}catch(t){}return{token:e.data.token,student:e.data.student}}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Login failed")}},async logout(){try{localStorage.removeItem("studentToken"),localStorage.removeItem("studentId"),localStorage.removeItem("userType")}catch(t){throw Error("Logout failed")}},async getCurrentStudent(){try{return(await o().get("/student/dashboard/me")).data}catch(a){var t,e;throw Error((null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch current student")}},async requestPasswordReset(t){try{return(await r.FH.post("/student/auth/request-password-reset",{email:t})).data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Password reset request failed")}},async resetPassword(t,e){try{return(await r.FH.post("/student/auth/reset-password",{token:t,password:e})).data}catch(t){var a,o;throw Error((null===(o=t.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)||"Password reset failed")}},async changePassword(t,e,a){try{return(await o().post("/student/auth/change-password",{studentId:t,oldPassword:e,newPassword:a})).data}catch(t){var r,s;throw Error((null===(s=t.response)||void 0===s?void 0:null===(r=s.data)||void 0===r?void 0:r.message)||"Password change failed")}},async getDashboardStats(){try{return(await o().get("/student/dashboard/stats")).data}catch(a){var t,e;throw Error((null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch dashboard stats")}},async getProfile(){try{return(await o().get("/student/dashboard/profile")).data}catch(a){var t,e;throw Error((null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch profile")}},async updateProfile(t){try{let e=await o().put("/student/dashboard/profile",t);try{o().post("/student/dashboard/activity-log",{action:"STUDENT_PROFILE_UPDATE",details:t}).catch(()=>{})}catch(t){}return e.data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Failed to update profile")}},async getAttendanceRecords(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await o().get("/student/dashboard/attendance/records",{params:t})).data}catch(t){var e,a;throw Error((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Failed to fetch attendance records")}},async getAttendanceStats(){try{return(await o().get("/student/dashboard/attendance/stats")).data}catch(a){var t,e;throw Error((null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch attendance stats")}},async getEnrolledCourses(){try{return(await o().get("/student/dashboard/courses")).data}catch(a){var t,e;throw Error((null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch enrolled courses")}},async createActivityLog(t){try{return(await o().post("/student/dashboard/activity-log",{action:t.action,details:t.details})).data}catch(t){return console.error("Failed to create student activity log:",t),null}}}},84867:(t,e,a)=>{"use strict";a.d(e,{H:()=>n,h:()=>i});var r=a(95155),o=a(12115),s=a(66982);let d=(0,o.createContext)(void 0),n=()=>{let t=(0,o.useContext)(d);if(void 0===t)throw Error("useStudentAuth must be used within a StudentAuthProvider");return t},i=t=>{let{children:e}=t,[a,n]=(0,o.useState)(null),[i,l]=(0,o.useState)(!0),u=async()=>{try{if(localStorage.getItem("studentToken")){let t=await s.Z.getProfile();return console.log("Profile refreshed:",t),n(t),t}}catch(t){throw console.error("Failed to refresh profile:",t),v(),t}};(0,o.useEffect)(()=>{(async()=>{try{localStorage.getItem("studentToken")&&await u()}catch(t){console.error("Auth initialization error:",t)}finally{l(!1)}})()},[]);let c=async(t,e,a)=>{n((await s.Z.login({rollNumber:t,email:e,password:a})).student)},h=async(t,e,a)=>await s.Z.register({rollNumber:t,email:e,password:a}),v=()=>{s.Z.logout(),n(null)};return(0,r.jsx)(d.Provider,{value:{student:a,isLoading:i,isAuthenticated:!!a,login:c,register:h,logout:v,refreshProfile:u},children:e})}},91164:(t,e,a)=>{Promise.resolve().then(a.bind(a,1686))}},t=>{var e=e=>t(t.s=e);t.O(0,[9268,2217,8441,1684,7358],()=>e(91164)),_N_E=t.O()}]);